version: 1.0
ATT&CK version: 8.2
creation date: 02/18/2021
name: 'Azure Web Application Firewall'
contact: ctid@mitre-engenuity.org
organization: Center for Threat Informed Defense (CTID)
platform: Azure
tags:
  - Azure Security Center Recommendation
  - Web
  - WAF
  - Web Access Firewall
description: > 
  Azure Web Application Firewall (WAF) provides centralized protection of your web applications 
  from common exploits and vulnerabilities.
techniques:
  - id: T1595
    name: Active Scanning
    technique-scores:
      - category: Protect
        value: Partial
        comments: 'Covers web app vulnerabilities, not other services.'
    sub-techniques-scores:
      - sub-techniques:
          - id: T1595.002
            name: Vulnerability Scanning
        scores:
          - category: Protect
            value: Partial
            comments: Focuses on web vulnerability scanning of OWASP Core Rule Set (CRS).
          - category: Detect
            value: Partial
  - id: T1189
    name: Drive-by Compromise
    technique-scores:
      - category: Protect
        value: Partial
      - category: Detect
        value: Partial
  - id: T1190
    name: Exploit Public-Facing Application
    technique-scores:
      - category: Protect
        value: Significant
      - category: Detect
        value: Significant
  - id: T1203
    name: Exploitation for Client Execution
    technique-scores:
      - category: Protect
        value: Partial
      - category: Detect
        value: Partial
  - id: T1205
    name: Traffic Signaling
    technique-scores:
      - category: Detect
        value: Minimal
        comments: Provides telemetry but wouldn't identify the activity as bad or block it
    sub-techniques-scores:
      - sub-techniques:
          - id: T1205.001
            name: Port Knocking
        scores:
          - category: Protect
            value: Minimal
            comments: May block some ports depending on firewall rules.
          - category: Detect
            value: Minimal
            comments: May provide telemetry but without identifying it as a Port Knocking activity
  - id: T1110
    name: Brute Force
    technique-scores:
      - category: Protect
        value: Partial
        comments: Covers some techniques traversing the perimeter.
      - category: Detect
        value: Partial
    sub-techniques-scores:
      - sub-techniques:
          - id: T1110.001
            name: Password Guessing
        scores:
          - category: Protect
            value: Significant
          - category: Detect
            value: Significant
      - sub-techniques:
          - id: T1110.003
            name: Password Spraying
        scores:
          - category: Protect
            value: Significant
          - category: Detect
            value: Significant
      - sub-techniques:
          - id: T1110.004
            name: Credential Stuffing
        scores:
          - category: Protect
            value: Partial
            comments: Review may depend on how noisy/threshold
          - category: Detect
            value: Partial
  - id: T1056
    name: Input Capture
    technique-scores:
      - category: Protect
        value: Partial
        comments: Web portal capture
      - category: Detect
        value: Partial
    sub-techniques-scores:
      - sub-techniques:
          - id: T1056.003
            name: Web Portal Capture
        scores:
          - category: Protect
            value: Partial
            comments: >-
              Review Direct attacks to compromise server (vs valid credentials) (or do we just
              focus on identifying/stopping the behavior once the portal is compromised?)
          - category: Detect
            value: Partial
  - id: T1526
    name: Cloud Service Discovery
    technique-scores:
      - category: Detect
        value: Minimal
        comments: 'Minimal: some telemetry for detect'
  - id: T1046
    name: Network Service Scanning
    technique-scores:
      - category: Protect
        value: Partial
        comments: May block some ports
      - category: Detect
        value: Partial
        comments: May provide telemetry or trigger a scanner signature
  - id: T1071
    name: Application Layer Protocol
    technique-scores:
      - category: Protect
        value: Partial
      - category: Detect
        value: Partial
    sub-techniques-scores:
      - sub-techniques:
          - id: T1071.001
            name: Web Protocols
        scores:
          - category: Protect
            value: Partial
          - category: Detect
            value: Partial
  - id: T1001
    name: Data Obfuscation
    technique-scores:
      - category: Protect
        value: Partial
        comments: Some protocol enforcement for T1001.003 Protocol Impersonation
      - category: Detect
        value: Partial
    sub-techniques-scores:
      - sub-techniques:
          - id: T1001.003
            name: Protocol Impersonation
        scores:
          - category: Protect
            value: Significant
          - category: Detect
            value: Significant
  - id: T1008
    name: Fallback Channels
    technique-scores:
      - category: Protect
        value: Partial
      - category: Detect
        value: Partial
  - id: T1572
    name: Protocol Tunneling
    technique-scores:
      - category: Protect
        value: Partial
      - category: Detect
        value: Partial
  - id: T1048
    name: Exfiltration Over Alternative Protocol
    technique-scores:
      - category: Protect
        value: Partial
      - category: Detect
        value: Partial
    sub-techniques-scores:
      - sub-techniques:
          - id: T1048.001
            name: Exfiltration Over Symmetric Encrypted Non-C2 Protocol
          - id: T1048.003
            name: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
          - id: T1048.002
            name: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol
        scores:
          - category: Protect
            value: Partial
          - category: Detect
            value: Partial
  - id: T1041
    name: Exfiltration Over C2 Channel
    technique-scores:
      - category: Protect
        value: Partial
      - category: Detect
        value: Partial
  - id: T1567
    name: Exfiltration Over Web Service
    technique-scores:
      - category: Protect
        value: Partial
      - category: Detect
        value: Partial
    sub-techniques-scores:
      - sub-techniques:
          - id: T1567.002
            name: Exfiltration to Cloud Storage
          - id: T1567.001
            name: Exfiltration to Code Repository
        scores:
          - category: Protect
            value: Minimal
            comments: Provides telemetry
          - category: Detect
            value: Minimal
            comments: Provides telemetry
  - id: T1491
    name: Defacement
    technique-scores:
      - category: Protect
        value: Partial
        comments: >-
          Note will identify direct attacks, not defacing due to abuse of a valid account, not
          internal defacement from compromised internal host
      - category: Detect
        value: Partial
    sub-techniques-scores:
      - sub-techniques:
          - id: T1491.002
            name: External Defacement
        scores:
          - category: Protect
            value: Significant
          - category: Detect
            value: Significant
  - id: T1499
    name: Endpoint Denial of Service
    technique-scores:
      - category: Protect
        value: Significant
      - category: Detect
        value: Significant
    sub-techniques-scores:
      - sub-techniques:
          - id: T1499.004
            name: Application or System Exploitation
          - id: T1499.003
            name: Application Exhaustion Flood
          - id: T1499.002
            name: Service Exhaustion Flood
          - id: T1499.001
            name: OS Exhaustion Flood
        scores:
          - category: Protect
            value: Significant
          - category: Detect
            value: Significant
references:
  - https://docs.microsoft.com/en-us/azure/web-application-firewall/overview
