version: 1
ATT&CK version: 8.1
creation date: 04/15/2021
name: Azure Sentinel Analytics
author: Matt Bajzek
contact: ctid@mitre-engenuity.org
organization: Center for Threat Informed Defense (CTID)
platform: Azure
description: Out of the box Azure Sentinel Analytics (from the rule template list)
techniques:
  - id: T1562
    name: Impair Defenses
    technique-scores:
      - category: Detect
        value: Minimal
        comments: TODO
    sub-techniques-scores:
      - sub-techniques:
          - id: T1562.001
            name: Disable or Modify Tools
        scores:
          - category: Detect
            value: Partial
            comments: >-
              Can detect "Starting or Stopping HealthService to Avoid Detection" to disable
              telemetry collection/detection at a default frequency of once per day.
      - sub-techniques:
          - id: T1562.008
            name: Disable Cloud Logs
        scores:
          - category: Detect
            value: Partial
            comments: Can detect "Exchange AuditLog disabled" events at a default frequency of once per day.
  - id: T1568
    name: Dynamic Resolution
    technique-scores:
      - category: Detect
        value: Minimal
        comments: TODO
    sub-techniques-scores:
      - sub-techniques:
          - id: T1568.002
            name: Domain Generation Algorithms
        scores:
          - category: Detect
            value: Partial
            comments: >-
              Can detect "Possible contact with a domain generated by a DGA" at a default frequency
              of once every 6 hours.
  - id: T1190
    name: Exploit Public-Facing Application
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          Can detect when "A potentially malicious web request was executed against a web server"
          based on a high ratio of blocked requests and unobstructed requests to a Web Application
          Firewall (WAF) for a given client IP and hostname, with a default frequency of once per
          day.
  - id: T1078
    name: Valid Accounts
    technique-scores:
      - category: Detect
        value: Minimal
        comments: TODO
    sub-techniques-scores:
      - sub-techniques:
          - id: T1078.004
            name: Cloud Accounts
          - id: T1078.002
            name: Domain Accounts
        scores:
          - category: Detect
            value: Minimal
            comments: >-
              Can detect "Anomalous sign-in location by user account and authenticating application"
              at a default rate of once per day, based on the past 14 days of Azure Active Directory
              sign-in events. Note that IP address location-based detection may result in a high
              false positive rate, and that misuse from a typical location is not covered.
  - id: T1137
    name: Office Application Startup
    technique-scores:
      - category: Detect
        value: Minimal
        comments: TODO
    sub-techniques-scores:
      - sub-techniques:
          - id: T1137.005
            name: Outlook Rules
        scores:
          - category: Detect
            value: Partial
            comments: >-
              Can detect a "Malicious Inbox Rule" intended to delete emails that contain certain
              keywords (generally meant to warn compromised users about adversary behaviors) at a
              default frequency of once per day.
  - id: T1110
    name: Brute Force
    technique-scores:
      - category: Detect
        value: Minimal
        comments: TODO
    sub-techniques-scores:
      - sub-techniques:
          - id: T1110.001
            name: Password Guessing
          - id: T1110.003
            name: Password Spraying
          - id: T1110.004
            name: Credential Stuffing
        scores:
          - category: Detect
            value: Partial
            comments: >-
              Can detect "Brute Force Attack against GitHub Account", and "Potential Password Spray
              Attack" based on periodic assessment of Azure Active Directory sign-in events and Okta
              console logins.
  - id: T1140
    name: Deobfuscate/Decode Files or Information
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          Can detect "Process executed from binary hidden in Base64 encoded file" based on security
          event searches for decoding by Python, bash/sh, and Ruby at a default frequency of once
          per day.
  - id: T1136
    name: Create Account
    technique-scores:
      - category: Detect
        value: Minimal
        comments: TODO
    sub-techniques-scores:
      - sub-techniques:
          - id: T1136.001
            name: Local Account
          - id: T1136.002
            name: Domain Account
          - id: T1136.003
            name: Cloud Account
        scores:
          - category: Detect
            value: Minimal
            comments: >-
              Can detect "User account created and deleted within 10 mins", which suggests the
              account may serve a malicious purpose, at a default frequency of once per day. Note
              that this only covers the case in which an adversary deletes the account within 10
              minutes of its creation.
  - id: T1558
    name: Steal or Forge Kerberos Tickets
    technique-scores:
      - category: Detect
        value: Minimal
        comments: TODO
    sub-techniques-scores:
      - sub-techniques:
          - id: T1558.003
            name: Kerberoasting
        scores:
          - category: Detect
            value: Partial
            comments: >-
              Can detect "Potential Kerberoasting" at a default frequency of once per hour based on
              the previous day of security events.
comments: >-
  Note: only mapped out of the box analytics. Did not score analytics that were specific ioc-based
  (e.g.  ip addresses or hashes ).  Did not score analytics that required a 3rd party integration
    (e.g. Alsid or TrendMicro). Refer to specific analytics by name in quotes.
