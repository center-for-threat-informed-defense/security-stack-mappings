version: 1
ATT&CK version: 8.1
creation date: 04/22/2021
name: Azure Sentinel Analytics 251-278
contact: ctid@mitre-engenuity.org
organization: Center for Threat Informed Defense (CTID)
platform: Azure
description: Out of the box Azure Sentinel Analytics (from the rule template list)
techniques:
  - id: T1573
    name: Encrypted Channel
    technique-scores:
      - category: Detect
        value: Minimal
        comments: Provides minimal coverage for one sub-technique of this technique.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1573.002
            name: Asymmetric Cryptography
        scores:
          - category: Detect
            value: Minimal
            comments: >-
              Can detect "DNS events related to ToR proxies", which may indicate adversary use of
              Tor. Provides only minimal coverage because it only covers a set of common domains and
              is easily bypassed via hardcoded IP addresses, redirection, etc.
  - id: T1090
    name: Proxy
    technique-scores:
      - category: Detect
        value: Minimal
        comments: Provides minimal coverage for one sub-technique of this technique.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1090.003
            name: Multi-hop Proxy
        scores:
          - category: Detect
            value: Minimal
            comments: >-
              Can detect "DNS events related to ToR proxies", which may indicate adversary use of
              Tor. Provides only minimal coverage because it only covers a set of common domains and
              is easily bypassed via hardcoded IP addresses, redirection, etc.
  - id: T1098
    name: Account Manipulation
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          Can detect "User account added to built in domain local or global group", which may
          indicate that an adversary is escalating an account's access for Privilege Escalation
          and/or to maintain Persistence. Can also detect "Multiple Password Reset by user" across
          Azure Active Directory, Office 365, and others via Security Events and Syslog. Does not
          specifically address sub-techniques, and has a potentially high false positive rate due to
          routine password changes.
  - id: T1562
    name: Impair Defenses
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          This control detects a highly specific behavior that applies to one sub-technique of this
          technique.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1562.006
            name: Indicator Blocking
        scores:
          - category: Detect
            value: Minimal
            comments: >-
              Can detect "Azure DevOps - Retention Reduced to Zero", which may indicate that an
              adversary is looking to reduce their malicious activity's footprint by preventing
              retention of artifacts. Control is specific to indicators produced by Azure DevOps.
  - id: T1496
    name: Resource Hijacking
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          Can detect "DNS events related to mining pools", which may indicate adversary use of
          resources to mine cryptocurrency. Provides only minimal coverage because it only covers a
          set of common domains and is easily bypassed via hardcoded IP addresses, redirection, etc.
  - id: T1110
    name: Brute Force
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control includes detection coverage for most of this technique's sub-techniques on a
          periodic basis.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1110.001
            name: Password Guessing
          - id: T1110.004
            name: Credential Stuffing
          - id: T1110.003
            name: Password Spraying
        scores:
          - category: Detect
            value: Partial
            comments: >-
              Can detect "Excessive Windows logon failures", "Failed login attempts to Azure
              Portal", which may indicate attempts to brute force  credentials. Can also detect
              "Failed logon attempts by valid accounts within 10 mins" when at least 20 failed logon
              attempts are made with a valid account within 10 minutes.
  - id: T1119
    name: Automated Collection
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          Can detect "Mass secret retrieval from Azure Key Vault" and "Azure Key Vault access
          TimeSeries anomaly" when a sudden increase in access count is detected, both of which may
          indicate that an adversary is dumping credentials via automated methods.
  - id: T1078
    name: Valid Accounts
    technique-scores:
      - category: Detect
        value: Minimal
        comments: This control only provides coverage for specific cases of the relevant sub-techniques.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1078.004
            name: Cloud Accounts
          - id: T1078.002
            name: Domain Accounts
        scores:
          - category: Detect
            value: Minimal
            comments: >-
              Can detect "Anomalous User Agent connection attempt" and "New UserAgent observed in
              last 24 hours", which may indicate that an account is being used from a new device,
              which may belong to an adversary. High probability of false positives and potentially
              inaccurate at detecting adversary behavior from a context similar to typical ones. Can
              also detect "Azure Active Directory PowerShell accessing non-AAD resources", which may
              indicate an adversary attempting to use a valid account to access resources from other
              contexts.
  - id: T1485
    name: Data Destruction
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          Can detect "Multiple Teams deleted by a single user" when a threshold is met for number of
          Teams deleted within an hour. Coverage is minimal because the control is limited to a
          specific resource (teams) and only works when the threshold is met.
comments: ''
