version: 1
ATT&CK version: 8.2
creation date: 03/25/2021
name: Azure DNS Analytics
contact: ctid@mitre-engenuity.org
organization: Center for Threat Informed Defense (CTID)
platform: Azure
tags:
  - DNS
  - Network
description: >-
  "DNS Analytics helps you to: identify clients that try to resolve malicious domain names,
  identify stale resource records, identify frequently queried domain names and talkative DNS clients, 
  view request load on DNS servers, and view dynamic DNS registration failures.

  The solution collects, analyzes, and correlates Windows DNS analytic and audit logs and other
  related data from your DNS servers."
techniques:
  - id: T1071
    name: Application Layer Protocol
    technique-scores:
      - category: Detect
        value: Partial
        comments: May detect C2 wrt DNS via frequent talkers.
      - category: Respond
        value: Partial
        comments: Can be used forensically to identify clients communicated with identified C2 hosts.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1071.004
            name: DNS
        scores:
          - category: Detect
            value: Partial
  - id: T1568
    name: Dynamic Resolution
    technique-scores:
      - category: Respond
        value: Partial
        comments: Can be used for after-the-fact analysis of potential fast-flux DNS C2
    sub-techniques-scores:
      - sub-techniques:
          - id: T1568.001
            name: Fast Flux DNS
          - id: T1568.002
            name: Domain Generation Algorithms
        scores:
          - category: Respond
            value: Significant
  - id: T1048
    name: Exfiltration Over Alternative Protocol
    technique-scores:
      - category: Detect
        value: Partial
        comments: Can identify anomalous / high talker DNS clients, possibly related to exfil via DNS
    sub-techniques-scores:
      - sub-techniques:
          - id: T1048.003
            name: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol
        scores:
          - category: Detect
            value: Partial
            comments: Detection restricted to DNS protocol
  - id: T1041
    name: Exfiltration Over C2 Channel
    technique-scores:
      - category: Detect
        value: Minimal
        comments: Detection restricted to DNS protocol
  - id: T1566
    name: Phishing
    technique-scores:
      - category: Detect
        value: Partial
        comments: Can detect DNS queries to known malicious sites
      - category: Respond
        value: Partial
        comments: Can identify clients that attempted to resolve previously unknown malicious sites
    sub-techniques-scores:
      - sub-techniques:
          - id: T1566.002
            name: Spearphishing Link
        scores:
          - category: Detect
            value: Partial
          - category: Respond
            value: Partial
comments: >-
  For temporal score, generally high with respect to access to known bad domains: "The event-related
  data is collected near real time from the analytic and audit logs provided by enhanced DNS logging
  and diagnostics in Windows Server 2012 R2.". DNS logs and analytics can be used in a response
  context, for example to identify client access to previously unknown malicious domains.  "Noisy"
  client alerts may be useful for identifying some C2 over DNS.
references:
  - 'https://docs.microsoft.com/en-us/azure/azure-monitor/insights/dns-analytics'
