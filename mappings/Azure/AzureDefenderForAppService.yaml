version: 1
ATT&CK version: 8.1
creation date: 04/05/2021
name: Azure Defender for App Service
author: Matt Bajzek
contact: ctid@mitre-engenuity.org
organization: Center for Threat Informed Defense (CTID)
platform: Azure
tags:
  - Azure Defender
  - Azure Security Center
  - Windows
  - Linux
  - Azure Defender for App Service
description: >-
  Azure Defender for App Service monitors VM instances and their management interfaces, App Service
  apps and their requests/responses, and App Service internal logs to detect threats to App Service
  resources and provide security recommendations to mitigate them.
techniques:
  - id: T1584
    name: Compromise Infrastructure
    technique-scores:
      - category: Protect
        value: Minimal
        comments: >-
          This control only addresses one of the technique's sub-techniques, resulting in a score of
          Minimal.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1584.001
            name: Domains
        scores:
          - category: Protect
            value: Significant
            comments: >-
              Subdomain hijacking is a focus of this control, and its Dangling DNS detection alert
              feature is activated when an App Service website is decommissioned and its
              corresponding DNS entry is not deleted, allowing users to remove those entries before
              they can be leveraged by an adversary.
  - id: T1496
    name: Resource Hijacking
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control detects file downloads associated with digital currency mining as well as
          host data related to process and command execution associated with mining. It also
          includes fileless attack detection, which specifically targets crypto mining activity.
          Temporal factor is unknown.
  - id: T1204
    name: User Execution
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          This control only provides meaningful detection for one of the technique's two
          sub-techniques, and temporal factor is unknown, resulting in a score of Minimal.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1204.001
            name: Malicious Link
        scores:
          - category: Detect
            value: Minimal
            comments: >-
              This control monitors for references to suspicious domain names and file downloads
              from known malware sources, and monitors processes for downloads from raw-data
              websites like Pastebin, all of which are relevant for detecting users' interactions
              with malicious download links, but malicious links which exploit browser
              vulnerabilities for execution are unlikely to be detected, and temporal factor is
              unknown, resulting in a score of Minimal.
  - id: T1140
    name: Deobfuscate/Decode Files or Information
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control analyzes host data to detect base-64 encoded executables within command
          sequences. It also monitors for use of certutil to decode executables. Temporal factor is
          unknown.
  - id: T1566
    name: Phishing
    technique-scores:
      - category: Protect
        value: Minimal
        comments: >-
          This control only provides (minimal) protection for one of the technique's sub-techniques,
          so its score is Minimal.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1566.002
            name: Spearphishing Link
        scores:
          - category: Protect
            value: Minimal
            comments: >-
              This control monitors for known phishing links on the Azure App Services website and
              generates alerts if they are detected, potentially preventing their access by users.
              This is a very specific avenue, only covers known links, and temporal factor is
              unknown, so score is Minimal.
  - id: T1059
    name: Command and Scripting Interpreter
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          This control only provides detection coverage for two sub-techniques, and only detects
          certain specific sub-technique behaviors, so score is Minimal.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1059.004
            name: Unix Shell
        scores:
          - category: Detect
            value: Minimal
            comments: >-
              This control monitors host data for potential reverse shells used for command and
              control. Temporal factor is unknown.
      - sub-techniques:
          - id: T1059.001
            name: PowerShell
        scores:
          - category: Detect
            value: Minimal
            comments: >-
              This control monitors for execution of known malicious PowerShell PowerSploit cmdlets.
              Temporal factor is uknown.
  - id: T1105
    name: Ingress Tool Transfer
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control detects binary downloads via certutil, monitors for FTP access from IP
          addresses found in threat intelligence, monitors for references to suspicious domain names
          and file downloads from known malware sources, and monitors processes for downloads from
          raw-data websites like Pastebin. Temporal factor is unknown.
  - id: T1595
    name: Active Scanning
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          This control only provides detection for one of the two sub-techniques, so score is
          Minimal.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1595.002
            name: Vulnerability Scanning
        scores:
          - category: Detect
            value: Partial
            comments: >-
              This control monitors for web fingerprinting tools including nmap and Blind Elephant,
              as well as scanners looking for vulnerability in applications like Drupal, Joomla, and
              WordPress. Temporal factor is unknown.
  - id: T1594
    name: Search Victim-Owned Websites
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control monitors for accesses of potentially sensitive web pages from source IP
          addresses whose access pattern resembles that of a web scanner or have not been logged
          before. Temporal factor is unknown.
  - id: T1055
    name: Process Injection
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control's Fileless Attack Detection covers all relevant sub-techniques. Detection is
          periodic at an unknown rate.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1055.001
            name: Dynamic-link Library Injection
          - id: T1055.002
            name: Portable Executable Injection
          - id: T1055.003
            name: Thread Execution Hijacking
          - id: T1055.004
            name: Asynchronous Procedure Call
          - id: T1055.005
            name: Thread Local Storage
          - id: T1055.011
            name: Extra Window Memory Injection
          - id: T1055.012
            name: Process Hollowing
          - id: T1055.013
            name: Process DoppelgÃ¤nging
          - id: T1055.008
            name: Ptrace System Calls
          - id: T1055.009
            name: Proc Memory
          - id: T1055.014
            name: VDSO Hijacking
        scores:
          - category: Detect
            value: Partial
            comments: >-
              Injection attacks are specifically cited as a detection focus for Fileless Attack
              Detection, which is part of this control, with even more specific references to
              Process Hollowing, executable image injection, and threads started in a dynamically
              allocated code segment. Detection is periodic at an unknown rate.
  - id: T1203
    name: Exploitation for Client Execution
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control's Fileless Attack Detection identifies shellcode executing within process
          memory, including shellcode executed as a payload in the exploitation of a software
          vulnerability. Detection is periodic at an unknown rate.
  - id: T1211
    name: Exploitation for Defense Evasion
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control's Fileless Attack Detection identifies shellcode executing within process
          memory, including shellcode executed as a payload in the exploitation of a software
          vulnerability. Detection is periodic at an unknown rate.
  - id: T1068
    name: Exploitation for Privilege Escalation
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control's Fileless Attack Detection identifies shellcode executing within process
          memory, including shellcode executed as a payload in the exploitation of a software
          vulnerability. Detection is periodic at an unknown rate.
  - id: T1212
    name: Exploitation for Credential Access
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control's Fileless Attack Detection identifies shellcode executing within process
          memory, including shellcode executed as a payload in the exploitation of a software
          vulnerability. Detection is periodic at an unknown rate.
  - id: T1189
    name: Drive-by Compromise
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control's Fileless Attack Detection identifies shellcode executing within process
          memory, including shellcode injected into browser or other process memory as part of a
          drive-by attack. Detection is periodic at an unknown rate.
  - id: T1190
    name: Exploit Public-Facing Application
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control's Fileless Attack Detection identifies shellcode executing within process
          memory, including shellcode injected to exploit a vulnerability in a public-facing
          application. Detection is periodic at an unknown rate.
  - id: T1210
    name: Exploitation of Remote Services
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control's Fileless Attack Detection identifies shellcode executing within process
          memory, including shellcode injected to exploit a vulnerability in an exposed service.
          Detection is periodic at an unknown rate.
  - id: T1559
    name: Inter-Process Communication
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control's Fileless Attack Detection covers the command execution aspects of both of
          this technique's sub-techniques. Detection is periodic at an unknown rate.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1559.001
            name: Component Object Model
          - id: T1559.002
            name: Dynamic Data Exchange
        scores:
          - category: Detect
            value: Partial
            comments: >-
              This control's Fileless Attack Detection identifies suspicious command execution
              within process memory. Detection is periodic at an unknown rate.
references:
  - 'https://docs.microsoft.com/en-us/azure/security-center/alerts-reference'
  - 'https://docs.microsoft.com/en-us/azure/security-center/defender-for-app-service-introduction'
  - 'https://azure.microsoft.com/en-us/services/app-service/'
  - 'https://docs.microsoft.com/en-us/azure/security-center/defender-for-servers-introduction'
