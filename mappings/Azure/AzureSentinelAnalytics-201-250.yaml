version: 1
ATT&CK version: 8.1
creation date: 04/20/2021
name: Azure Sentinel Analytics 201-250
contact: ctid@mitre-engenuity.org
organization: Center for Threat Informed Defense (CTID)
platform: Azure
tags:
  - Analytics
description: Out of the box analytic rule templates for Azure Sentinel
techniques:
  - id: T1078
    name: Valid Accounts
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "Anomalous SSH Login Detection" can identify some suspicious ssh logins potentially
          indicative of Valid Acct technique. (local)

          "Anomalous RDP Login Detections" can identify some suspicious  RDP activity indicative of
          Valid Account technique (domain and local)

          "Login to AWS management console without MFA" can identify potential use of Valid Account
          technique (cloud acct)
    sub-techniques-scores:
      - sub-techniques:
          - id: T1078.003
            name: Local Accounts
          - id: T1078.002
            name: Domain Accounts
        scores:
          - category: Detect
            value: Partial
  - id: T1021
    name: Remote Services
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "Anomalous RDP Login Detections" can identify some potentially suspicious use of RDP

          "Multiple RDP connections from Single Systems" can identify above-threshold activity of
          RDP potentially indicative of lateral movement.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1021.001
            name: Remote Desktop Protocol
        scores:
          - category: Detect
            value: Partial
            comments: Can detect some anomalous RDP activity
  - id: T1098
    name: Account Manipulation
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "External User Access Enabled" identifies potentially malicious changes to external domain
          access specific to Zoom.

          "External user added and removed in short timeframe" can detect potential account
          manipulation technique, specific to Teams.

          "New user created and added to the built-in administrator group "  can identify potential
          attempt to maintain persistence with a new user assigned admin privileges.

          "Account added and removed from privileged group" can identify potential attempt to evade
          defense and escalate privilege.
  - id: T1496
    name: Resource Hijacking
    technique-scores:
      - category: Detect
        value: Partial
        comments: |-
          "Creation of Expensive Computes in Azure" identifies potential resource hijacking.
          "Suspicious Resource deployment" can identify potential resource hijacking.
  - id: T1110
    name: Brute Force
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "SSH - Potential Brute Force" can detect potential Brute force password guessing for SSH

          "SecurityEvent - Multiple authentication failures followed by success" can identify brute
          force attempts wrt domain access.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1110.001
            name: Password Guessing
        scores:
          - category: Detect
            value: Partial
  - id: T1490
    name: Inhibit System Recovery
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "Sensitive Azure Key Vault Operations" may help identify attacker activity that interfers
          with backups
  - id: T1486
    name: Data Encrypted for Impact
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "Sensitive Azure Key Vault operations" may help identify attacker attempting to impact
          data by deleting private key(s) required to decrypt.
  - id: T1531
    name: Account Access Removal
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "Sensitive Azure Key Vault operations" may identify attempts to remove account access by
          deleting keys or deleting entire key vault.
  - id: T1119
    name: Automated Collection
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "Users searching for VIP user activity" can identify potentially suspicious Log Analytics
          queries by users looking for a listing of "VIP" activity.
  - id: T1105
    name: Ingress Tool Transfer
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "New executable via Office FileUploaded Operations" can help identify potential ingress of
          malicious code and attacker tools to Office services such as Sharepoint and OneDrive
          (though may generate false positives from normal user exe upload activity)
  - id: T1534
    name: Internal Spearphishing
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "suspicious link sharing pattern" can identify potential internal lateral movement via
          spearphishing (albeit leveraging Zoom not email). Simple threshold rule for specific
          service, so minimal score. perhaps candidate for new sub-technique of internal
          spearphishing .
  - id: T1535
    name: Unused/Unsupported Cloud Regions
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "Suspicious Resource deployment" can identify potential attacker attempt to maintain
          persistence or evade defense. by leveraging unused/unmonitored resources.
  - id: T1071
    name: Application Layer Protocol
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "Request for single resource on domain" can detect a specific pattern for potential C2
          "Beaconing" via web request.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1071.001
            name: Web Protocols
        scores:
          - category: Detect
            value: Minimal
            comments: >-
              "Request for single resource on domain" can identify specific pattern for potential C2
              beaconing.
  - id: T1136
    name: Create Account
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "New Cloud Shell User" identifies new Azure cloud Shell  that could be potential attempts
          to maintain persistence.
    sub-techniques-scores:
      - sub-techniques:
          - id: T1136.003
            name: Cloud Account
        scores:
          - category: Detect
            value: Partial
  - id: T1059
    name: Command and Scripting Interpreter
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          "New CloudShell User" can detect potentially suspicious Commandline/shell activity.
          Candidate for additional sub-technique (Cloud Shell, vs powershell etc)

          "Rare and Potentially high-risk Office operations" can identify specific rare
          mailbox-related account and permission changes.
comments: >-
  No scoring of 3rd party-dependent analytics or ioc-based analytics (e.g. IP addresses from Threat
  Intelligence feed)
