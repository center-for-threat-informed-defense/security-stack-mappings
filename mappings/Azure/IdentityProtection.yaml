version: 1
ATT&CK version: 8.1
creation date: 03/4/2021
name: Azure AD Identity Protection
contact: ctid@mitre-engenuity.org
organization: Center for Threat Informed Defense (CTID)
platform: Azure
tags:
  - Credentials
  - Azure Active Directory
  - Identity
  - Microsoft 365 Defender
description: |
  Identity Protection is a tool that allows organizations to accomplish three key tasks:
  Automate the detection and remediation of identity-based risks.
  Investigate risks using data in the portal.
  Export risk detection data to third-party utilities for further analysis.
techniques:
  - id: T1078
    name: Valid Accounts
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
          This control only protects cloud accounts and therefore its overall detection coverage is
          minimal.
      - category: Respond
        value: Minimal
        comments: >-
          Provides Significant response capabilities for one of this technique's sub-techniques
          (cloud accounts).
    sub-techniques-scores:
      - sub-techniques:
          - id: T1078.004
            name: Cloud Accounts
        scores:
          - category: Detect
            value: Partial
            comments: >-
              This control provides risk detections that can be used to detect suspicious uses of
              valid accounts, e.g.:  Anonymous IP address, Atypical travel, Malware linked IP
              address, Unfamiliar sign-in properties, etc.  Microsoft utilizes machine learning and
              heuristic systems to reduce the false positive rate but there will be false positives.

              The temporal factor of this control's detection is low because although there are some
              real-time detections most are offline detections (multi-day).
          - category: Respond
            value: Significant
            comments: >-
              Response Type:  Eradication

              Supports blocking and resetting the user's credentials based on the detection of a
              risky user/sign-in manually and also supports automation via its user and sign-in risk
              policies.
  - id: T1606
    name: Forge Web Credentials
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
          This control can be effective at detecting forged web credentials because it uses
          environment properties (e.g. IP address, device info, etc.) to detect risky users and
          sign-ins even when valid credentials are utilized.  It provides partial coverage of this
          techniques sub-techniques and therefore has been assessed a Partial score.
      - category: Respond
        value: Partial
        comments: >-
          Provides Significant response capabilities for one of this technique's sub-techniques
          (SAML tokens).
    sub-techniques-scores:
      - sub-techniques:
          - id: T1606.002
            name: SAML Tokens
        scores:
          - category: Detect
            value: Partial
            comments: >-
              This control supports detecting risky sign-ins and users that involve federated users
              and therefore can potentially alert on this activity.  Not all alert types for this
              control support federated accounts therefore the detection coverage for this technique
              is partial.
          - category: Respond
            value: Significant
            comments: >-
              Response Type:  Eradication

              Supports blocking and resetting the user's credentials based on the detection of a
              risky user/sign-in manually and also supports automation via its user and sign-in risk
              policies.
references:
  - >-
    https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/howto-identity-protection-investigate-risk
  - >-
    https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/overview-identity-protection
  - >-
    https://docs.microsoft.com/en-us/azure/active-directory/identity-protection/concept-identity-protection-risks
  - >-
    https://techcommunity.microsoft.com/t5/azure-active-directory-identity/azuread-identity-protection-adds-support-for-federated/ba-p/244328
