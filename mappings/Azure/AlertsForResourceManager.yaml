version: 1.0
ATT&CK version: 8.2
creation date: 2/17/2021
name: Azure Defender for Resource Manager
contact: ctid@mitre-engenuity.org
organization: Center for Threat Informed Defense (CTID)
platform: Azure
tags:
  - Azure Defender
description: >
  Azure Defender for Resource Manager automatically monitors the 
  resource management operations in your organization, whether they're 
  performed through the Azure portal, Azure REST APIs, Azure CLI, or 
  other Azure programmatic clients. Alerts are generated by threats 
  detected in Azure Resource Manager logs and Azure Activity logs. 
  Azure Defender runs advanced security analytics to detect threats 
  and alert you about suspicious activity.
techniques:
  - id: T1562
    name: Impair Defenses
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
                 This control may alert on Windows Defender security 
                 features being disabled but does not alert on other
                 security tools or logging being disabled or tampered
                 with. Consequently, its Coverage score is Minimal 
                 resulting in an overall Minimal score.
    sub-techniques-scores:
      - sub-techniques:
        - id: T1562.001
          name: Disable or Modify Tools
        scores:
          - category: Detect
            value: Partial
            comments: >-
                     The following alerts are available for Windows Defender
                     security features being disabled but none for third
                     party security tools:
                     "Antimalware broad files exclusion in your virtual machine",
                     "Antimalware disabled and code execution in your virtual machine",
                     "Antimalware disabled in your virtual machine", "Antimalware
                     file exclusion and code execution in your virtual machine", "Antimalware
                     file exclusion in your virtual machine", "Antimalware real-time protection
                     was disabled in your virtual machine", "Antimalware real-time protection 
                     was disabled temporarily in your virtual machine", "Antimalware real-time 
                     protection was disabled temporarily while code was executed in your virtual 
                     machine", "Antimalware temporarily disabled in your virtual machine", 
                     "Antimalware unusual file exclusion in your virtual machine".
  - id: T1580
    name: Cloud Infrastructure Discovery
    technique-scores:
      - category: Detect
        value: Partial
        comments: >- 
                 This control may alert on Cloud Infrastructure Discovery
                 activity generated by specific toolkits, such as MicroBurst,
                 PowerZure, etc. It may not generate alerts on undocumented discovery 
                 techniques or exploitation toolkits. The following alerts may be 
                 generated:
                 "PowerZure exploitation toolkit used to enumerate storage containers, shares,
                 and tables", "PowerZure exploitation toolkit used to enumerate resources",
                 "MicroBurst exploitation toolkit used to enumerate resources in your subscriptions",
                 "Azurite toolkit run detected".

  - id: T1538
    name: Cloud Service Dashboard
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
                 This control may alert on suspicious management activity based on IP, time, anomalous
                 behaviour, or PowerShell usage. Machine learning algorithms are used to reduce false
                 positives. The following alerts may be generated:
                 "Activity from a risky IP address", "Activity from infrequent country", "Impossible
                 travel activity", "Suspicious management session using PowerShell detected", "Suspicious
                 management session using an inactive account detected", "Suspicious management session 
                 using Azure portal detected".
  - id: T1526
    name: Cloud Service Discovery
    technique-scores:
      - category: Detect
        value: Partial
        comments: >-
                 This control may alert on Cloud Service Discovery
                 activity generated by specific toolkits, such as MicroBurst,
                 PowerZure, etc. It may not generate alerts on undocumented discovery 
                 techniques or exploitation toolkits. The following alerts may be 
                 generated:
                 "PowerZure exploitation toolkit used to enumerate storage containers, shares,
                 and tables", "PowerZure exploitation toolkit used to enumerate resources",
                 "MicroBurst exploitation toolkit used to enumerate resources in your subscriptions".
  - id: T1069
    name: Permission Groups Discovery
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
                 This control may alert on Azure domain cloud groups discovery
                 activity but may not provide alerts for other account types
                 or undocumented exploitation toolkits.  Consequently, its Coverage 
                 score is Minimal resulting in an overall Minimal score.
    sub-techniques-scores:
      - sub-techniques:
        - id: T1069.003
          name: Cloud Groups
        scores:
          - category: Detect
            value: Partial
            comments: >-
                     This control may alert on Permission Groups Discovery of 
                     Cloud Groups activity generated by specific toolkits, such as
                     MicroBurst, PowerZure, etc. It may not generate alerts on undocumented
                     discovery techniques or exploitation toolkits. The following alerts
                     may be generated:
                     "MicroBurst exploitation toolkit used to enumerate resources in your subscriptions",
                     "Azurite toolkit run detected".
  - id: T1087
    name: Account Discovery
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
                 This control may alert on Azure cloud account discovery
                 activity but may not provide alerts for other account types
                 or undocumented exploitation toolkits. Consequently, its Coverage 
                 score is Minimal resulting in an overall Minimal score.
    sub-techniques-scores:
      - sub-techniques:
        - id: T1087.004
          name: Cloud Account
        scores:
          - category: Detect
            value: Partial
            comments: >-
                     This control may alert on Account Discovery of 
                     Cloud Accounts activity generated by specific toolkits, such as
                     MicroBurst, PowerZure, etc. It may not generate alerts on undocumented
                     discovery techniques or exploitation toolkits. The following alerts may be 
                     generated:
                     "PowerZure exploitation toolkit used to enumerate storage containers, shares,
                     and tables", "PowerZure exploitation toolkit used to enumerate resources",
                     "MicroBurst exploitation toolkit used to enumerate resources in your subscriptions",
                     "Azurite toolkit run detected".
  - id: T1555
    name: Credentials from Password Stores
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
                This control may alert on credential dumping from Azure Key Vaults, App Services
                Configurations, and Automation accounts by specific exploitation toolkits. Consequently, 
                its Coverage score is Minimal resulting in an overall Minimal score. The following alerts
                may be generated:
                "MicroBurst exploitation toolkit used to extract secrets from your Azure key vaults",
                "MicroBurst exploitation toolkit used to extract keys to your storage accounts".
  - id: T1068
    name: Exploitation for Privilege Escalation
    technique-scores:
      - category: Detect
        value: Minimal
        comments: >-
                This control may alert on escalation attempts from Azure AD to Azure accounts by 
                specific exploitation toolkits. Consequently, its Coverage score is Minimal 
                resulting in an overall Minimal score. The following alerts may be generated:
                "PowerZure exploitation toolkit used to elevate access from Azure AD to Azure".
comments: >
references:
  - https://docs.microsoft.com/en-us/azure/security-center/defender-for-resource-manager-introduction
  - https://docs.microsoft.com/en-us/azure/security-center/alerts-reference#alerts-resourcemanager
